<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Piano Dieta Settimanale</title>
</head>
<body>
<noscript style="padding:12px;display:block;background:#fee2e2;color:#111">
  Per usare questa app serve JavaScript attivo nel browser.
</noscript>

<header>
  <h1>Piano Dieta Settimanale</h1>
  <p>Schede: Planner - Impostazioni - Alimenti - Anteprima</p>
</header>

<nav class="tabs noprint">
  <button class="tab-btn active" data-tab="page-planner">Planner</button>
  <button class="tab-btn" data-tab="page-settings">Impostazioni</button>
  <button class="tab-btn" data-tab="page-foods">Alimenti</button>
  <button class="tab-btn" data-tab="page-preview">Anteprima</button>
</nav>

<!-- PLANNER (senza bottone esporta) -->
<section id="page-planner" class="page active">
  <div class="panel">
    <div class="sec">
      <h3>Planner Pasti Giornalieri</h3>
      <div id="mealsContainer" class="grid"></div>
    </div>

    <div class="sec">
      <div class="inline" style="justify-content:space-between">
        <h3>Riepilogo giornaliero</h3>
        <span class="badge" id="dailySummary"></span>
      </div>
      <div id="warnings" class="muted"></div>
    </div>

    <div class="sec">
      <h3>Calorie per macro</h3>
      <div class="inline">
        <span class="tag c">Carbo 4 kcal/g</span>
        <span class="tag p">Proteine 4 kcal/g</span>
        <span class="tag f">Grassi 9 kcal/g</span>
      </div>
    </div>
  </div>
</section>

<!-- SETTINGS -->
<section id="page-settings" class="page">
  <div class="panel">
    <div class="sec">
      <h3>Profilo</h3>
      <div class="row two">
        <select id="profileSelect"></select>
        <button class="btn" id="addProfileBtn">Nuovo</button>
      </div>
      <div class="row two" style="margin-top:6px">
        <button class="secondary" id="renameProfileBtn">Rinomina</button>
        <button class="secondary" id="delProfileBtn">Elimina</button>
      </div>
      <div class="row two" style="margin-top:6px">
        <button class="secondary" id="exportProfileBtn" title="Scarica JSON profilo">Esporta</button>
        <button class="secondary" id="importProfileBtn" title="Carica JSON profilo">Importa</button>
        <input type="file" id="profileFile" accept="application/json" style="display:none">
      </div>
    </div>

    <div class="sec">
      <h3>Fase e target</h3>
      <div class="row two">
        <div class="inline">
          <select id="phase">
            <option value="bulk">Bulk</option>
            <option value="cut">Cut</option>
          </select>
        </div>
        <div class="inline">
          <input id="weight" type="number" min="30" step="0.1" placeholder="Peso">
          <span class="unit">kg</span>
        </div>
      </div>
      <div class="row two" style="margin-top:6px">
        <div class="inline">
          <input id="kcalTarget" type="number" min="800" step="10" placeholder="Kcal al giorno">
          <span class="unit">kcal/die</span>
        </div>
        <select id="macroMode">
          <option value="auto">Calcolo automatico</option>
          <option value="manual">Inserimento manuale</option>
        </select>
      </div>
      <div class="row three" style="margin-top:6px">
        <div class="inline"><input id="carbDay" type="number" step="1" placeholder="Carbo"><span class="unit">g/die</span></div>
        <div class="inline"><input id="protDay" type="number" step="1" placeholder="Proteine"><span class="unit">g/die</span></div>
        <div class="inline"><input id="fatDay"  type="number" step="1" placeholder="Grassi"><span class="unit">g/die</span></div>
      </div>
      <div class="muted" id="macroHint" style="margin-top:6px"></div>
    </div>

    <!-- Moltiplicatori g/kg -->
    <div class="sec">
      <h3>Moltiplicatori g/kg (per calcolo automatico)</h3>
      <div class="row two">
        <div class="panel" style="padding:10px">
          <div class="inline"><strong>Bulk</strong><span class="tag">default P 1.6, F 1.0</span></div>
          <div class="row two" style="margin-top:6px">
            <div class="inline"><input id="bulkProt" type="number" step="0.1" min="0" placeholder="Proteine"><span class="unit">g/kg</span></div>
            <div class="inline"><input id="bulkFat"  type="number" step="0.1" min="0" placeholder="Grassi"><span class="unit">g/kg</span></div>
          </div>
        </div>
        <div class="panel" style="padding:10px">
          <div class="inline"><strong>Cut</strong><span class="tag">default P 2.2, F 0.8</span></div>
          <div class="row two" style="margin-top:6px">
            <div class="inline"><input id="cutProt" type="number" step="0.1" min="0" placeholder="Proteine"><span class="unit">g/kg</span></div>
            <div class="inline"><input id="cutFat"  type="number" step="0.1" min="0" placeholder="Grassi"><span class="unit">g/kg</span></div>
          </div>
        </div>
      </div>
      <div class="row two" style="margin-top:6px">
        <button class="secondary" id="resetFactorsBtn">Ripristina default</button>
        <span class="muted">Se modalit√† = Calcolo automatico, i nuovi fattori si applicano subito.</span>
      </div>
      <div id="factorFieldHint" class="hintbar"></div>
    </div>

    <!-- Distribuzione -->
    <div class="sec">
      <h3>Pasti</h3>
      <div class="row two">
        <input id="mealsCount" type="number" min="1" max="10" value="3" />
        <select id="splitMode">
          <option value="percent">Distribuzione per %</option>
          <option value="manual">Manuale (g per pasto)</option>
        </select>
      </div>
      <div id="percentages" class="row" style="margin-top:6px"></div>
      <div class="row two" style="margin-top:6px">
        <button class="btn" id="applySplitBtn" disabled>Applica distribuzione</button>
        <button class="secondary" id="resetMealsBtn">Reimposta pasti</button>
      </div>
    </div>

    <!-- Interfaccia globale -->
    <div class="sec">
      <h3>Interfaccia</h3>
      <div class="row two">
        <label class="inline">
          <input type="checkbox" id="toggleHints"/>
          <span>Mostra suggerimenti (hints) in Planner e Alimenti</span>
        </label>
        <label class="inline">
          <input type="checkbox" id="snapManual5"/>
          <span>Aggancia i grammi inseriti manualmente a multipli di 5 g</span>
        </label>
      </div>
    </div>

    <!-- Anteprima / PDF -->
    <div class="sec">
      <h3>Anteprima / PDF</h3>
      <div class="row four">
        <label class="inline"><input type="checkbox" id="showColC" checked/> <span>Mostra Carboidrati (C)</span></label>
        <label class="inline"><input type="checkbox" id="showColP" checked/> <span>Mostra Proteine (P)</span></label>
        <label class="inline"><input type="checkbox" id="showColF" checked/> <span>Mostra Grassi (G)</span></label>
        <label class="inline"><input type="checkbox" id="showTargets" checked/> <span>Mostra target del pasto</span></label>
      </div>
      <div class="muted" style="margin-top:6px">
        Le preferenze sono globali e si applicano sia alla scheda Anteprima che al PDF.
      </div>
    </div>
  </div>
</section>

<!-- FOODS -->
<section id="page-foods" class="page">
  <div class="panel">
    <div class="sec">
      <h3>Alimenti</h3>
      <div class="row">
        <input id="foodSearch" placeholder="Cerca alimento...">

        <!-- Form: senza alcool/fibra/zuccheri -->
        <div class="row three">
          <input id="fName" placeholder="Nome">
          <input id="fKcal" type="number" step="0.1" placeholder="Energia (kcal/100g)">
          <input id="fCarb" type="number" step="0.1" placeholder="Carbo (g/100g)">
          <input id="fProt" type="number" step="0.1" placeholder="Proteine (g/100g)">
          <input id="fFat"  type="number" step="0.1" placeholder="Grassi (g/100g)">
          <button class="btn" id="addFoodBtn">Aggiungi/Salva</button>
        </div>

        <!-- Hint + anteprima macro -->
        <div id="foodFieldHint" class="hintbar"></div>
        <div id="foodMacroPreview" class="inline" style="margin-top:6px">
          <span>Dominante:</span>
          <span id="foodDominant" class="tag">-</span>
          <span class="muted" id="foodMacroLine">C 0 g - P 0 g - G 0 g</span>
          <span class="muted" id="foodKcalEst"></span>
        </div>

        <!-- Azioni lista -->
        <div class="inline right noprint" style="margin-top:4px">
          <button class="secondary" id="exportFoodsBtn">Esporta alimenti</button>
          <button class="secondary" id="importFoodsBtn">Importa alimenti</button>
          <input type="file" id="foodsFile" accept=".json,.csv" style="display:none">
        </div>
        <div class="inline right noprint" style="margin-top:4px">
          <button class="secondary" id="collapseAllBtn">Comprimi tutti</button>
          <button class="secondary" id="expandAllBtn">Espandi tutti</button>
        </div>

        <!-- Gruppi -->
        <div id="foodsGroups"></div>
      </div>
    </div>
  </div>
</section>

<!-- PREVIEW -->
<section id="page-preview" class="page">
  <div class="panel">
    <div class="sec">
      <h3>Anteprima esportazione</h3>
      <div class="inline" style="justify-content:space-between">
        <div class="inline">
          <span class="muted">Legenda tipi pasto:</span>
          <span class="var-badge var0">Tipo 1</span>
          <span class="var-badge var1">Tipo 2</span>
          <span class="var-badge var2">Tipo 3</span>
          <span class="var-badge var3">Tipo 4</span>
          <span class="var-badge var4">Tipo 5</span>
          <span class="var-badge var5">Tipo 6</span>
        </div>
        <button class="btn" id="previewExportBtn">Esporta PDF</button>
      </div>
    </div>
    <div id="previewContainer"></div>
  </div>
</section>
  <script type="module" src="/src/main.js"></script>
</body>
</html>
